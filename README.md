# Incubator for Europeana Portal in vue.js + nuxt.js
 [![Build Status](https://travis-ci.com/europeana/incubator-portal-vue-nuxt.svg?branch=master)](https://travis-ci.com/europeana/incubator-portal-vue-nuxt) [![Maintainability](https://api.codeclimate.com/v1/badges/6d547010dcc180c40cf5/maintainability)](https://codeclimate.com/github/europeana/incubator-portal-vue-nuxt/maintainability) [![Test Coverage](https://api.codeclimate.com/v1/badges/6d547010dcc180c40cf5/test_coverage)](https://codeclimate.com/github/europeana/incubator-portal-vue-nuxt/test_coverage)
## Build Setup

``` bash
# install dependencies
$ npm install

# serve with hot reload at localhost:3000
$ npm run dev

# build for production and launch server
$ npm run build
$ npm start

# generate static project
$ npm run generate

# serve storybook with hot reload at localhost:6006
$ npm run storybook

# generate static storybook
$ npm run build-storybook

```

For detailed explanation on how things work, checkout [Nuxt.js docs](https://nuxtjs.org).

## Testing

Run tests with:

```bash
$ npm test
```
### Running unit tests only
`npm run test:unit` just runs everything.

To run a single file: `npm run test:unit -g tests/unit/[REST_OF_FILE_PATH]`

### Running end to end tests only

`npm run test:e2e` and `npm run test:e2e:ci` just run everything.

If you've manually started the test server with: `npm run build:test && npm run start:test`, then you can for example:

Run only the header.feature file using path.

```shell
npm run test:chrome:headless tests/features/header.feature
```

Run only the "header" feature test using its name.

```shell
npm run test:chrome:headless -- -p all --name header
```

Run only the "header" feature in the header file.

```shell
npm run test:chrome:headless tests/features/header.feature -- --name header
```

Run everything with your driver of choice.

```
npm run test:chrome:headless -- -p all
```

`test:chrome:headless` can be substituited for the other avialable driver commands `test:gecko` and `test:chrome`.

Be aware however that with `geckodriver` some tests are known to fail as it is not yet feature complete.
It is therefore at present of limited use.


## Bundlesize

[bundlesize.config.json](./bundlesize.config.json) is a configuration file for
[bundlesize](https://www.npmjs.com/package/bundlesize).

The `maxSize` values are for gzipped assets, as that is how they will be
served in a production environment.

To test, run:
- `npm run build`
- `npx bundlesize`

When new pages are added to the Nuxt app, or new combined assets for
multiple pages generated by the Nuxt build, they will need to be added to
this manifest.

Recommended `maxSize` values:
- App page code (in `./nuxt/dist/client/pages/`): 7.5 kB
- Vendored page code (`./nuxt/dist/client/vendors.pages/`): 15 kB


## License

Licensed under the EUPL v1.2.

For full details, see [LICENSE.md](LICENSE.md).
